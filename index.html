<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>çŒ«çŒ«å¿«é€’æŸ¥è¯¢</title>
  <style>
    :root{
      --bg:#ffe6f0;
      --card:#ffffffcc;
      --pink:#ff5fa2;
      --pink2:#ff86ba;
      --text:#3a2b35;
    }
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "PingFang SC", "Microsoft YaHei";
      background: radial-gradient(1200px 600px at 20% 0%, #fff 0%, var(--bg) 55%, #ffd1e5 100%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .wrap{ width:min(720px, 100%); }
    .header{
      display:flex; gap:16px; align-items:center;
      margin-bottom:16px;
    }
    .cat{
      width:64px; height:64px; flex:0 0 64px;
      filter: drop-shadow(0 10px 18px rgba(255,95,162,.25));
    }
    .title h1{ margin:0; font-size:22px; }
    .title p{ margin:6px 0 0; opacity:.8; }
    .card{
      background:var(--card);
      border:1px solid #ffd1e5;
      border-radius:18px;
      padding:18px;
      box-shadow: 0 18px 40px rgba(0,0,0,.08);
      backdrop-filter: blur(10px);
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; }
    .row > * { flex:1; }
    label{ font-size:12px; opacity:.8; display:block; margin:10px 0 6px; }
    input, select{
      width:100%;
      border:1px solid #ffd1e5;
      border-radius:12px;
      padding:12px 12px;
      font-size:14px;
      outline:none;
      background:#fff;
    }
    input:focus{ border-color: var(--pink2); box-shadow:0 0 0 4px rgba(255,134,186,.25); }
    button{
      width:100%;
      margin-top:12px;
      border:0;
      border-radius:14px;
      padding:12px 14px;
      font-size:15px;
      color:#fff;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      cursor:pointer;
      box-shadow:0 14px 26px rgba(255,95,162,.25);
    }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .result{
      margin-top:14px;
      padding:12px;
      border-radius:14px;
      border:1px dashed #ffb5d2;
      background:#fff7fb;
      display:none;
    }
    .pill{
      display:inline-block;
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      background:#ffe1ef;
      border:1px solid #ffc2dc;
      margin-right:8px;
    }
    .timeline{ margin-top:10px; }
    .event{ padding:10px 0; border-top:1px solid #ffe1ef; }
    .event:first-child{ border-top:0; }
    .muted{ opacity:.75; font-size:12px; }
    .err{ color:#b0003a; }
    footer{ margin-top:12px; text-align:center; font-size:12px; opacity:.65; }
  </style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <svg class="cat" viewBox="0 0 128 128" aria-hidden="true">
      <path fill="#ff86ba" d="M24 52c0-18 10-32 24-40l8 24 8-24c14 8 24 22 24 40v36c0 14-12 26-24 26H72c-4 0-8-2-8-6s4-6 8-6h8c6 0 12-6 12-14V52c0-10-4-18-10-24l-6 18c-2 6-10 6-12 0l-6-18c-6 6-10 14-10 24v36c0 8 6 14 12 14h8c4 0 8 2 8 6s-4 6-8 6H60c-12 0-24-12-24-26V52z"/>
      <circle cx="52" cy="70" r="6" fill="#3a2b35"/>
      <circle cx="76" cy="70" r="6" fill="#3a2b35"/>
      <path d="M62 80c2 2 2 2 4 0" stroke="#3a2b35" stroke-width="4" stroke-linecap="round"/>
      <path d="M46 84c6 4 10 4 16 0M66 84c6 4 10 4 16 0" stroke="#ff5fa2" stroke-width="4" stroke-linecap="round" fill="none"/>
    </svg>
    <div class="title">
      <h1>çŒ«çŒ«å¿«é€’æŸ¥è¯¢</h1>
      <p>è¾“å…¥æ‰‹æœºå·æˆ–ç½‘åï¼Œçœ‹çœ‹å°åŒ…è£¹èµ°åˆ°å“ªå•¦ ğŸ¾</p>
    </div>
  </div>

  <div class="card">
    <div class="row">
      <div>
        <label>æŸ¥è¯¢æ–¹å¼</label>
        <select id="mode">
          <option value="phone">æ‰‹æœºå·</option>
          <option value="nick">ç½‘å</option>
        </select>
      </div>
      <div>
        <label>å£ä»¤ï¼ˆå¯é€‰ï¼Œå»ºè®®åŠ ä¸€å±‚ä¿æŠ¤ï¼‰</label>
        <input id="passcode" placeholder="ä¾‹å¦‚ç¾¤é‡Œå‘çš„ 6 ä½ç " />
      </div>
    </div>

    <label id="keyLabel">æ‰‹æœºå·</label>
    <input id="keyInput" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" />

    <button id="btn">æŸ¥è¯¢ä¸€ä¸‹</button>

    <div class="result" id="result"></div>
    <footer>åªå±•ç¤ºè¯¥æ‰‹æœºå·/ç½‘åå¯¹åº”çš„é‚£ä¸€å•ï¼›ä¸å…¬å¼€ä½ çš„ä¸ªäººä¿¡æ¯ã€‚</footer>
  </div>
</div>

<script>
  const API_BASE = "https://YOUR-WORKER.your-subdomain.workers.dev"; // æ”¹æˆä½ çš„åç«¯åœ°å€

  const modeEl = document.getElementById("mode");
  const labelEl = document.getElementById("keyLabel");
  const inputEl = document.getElementById("keyInput");
  const passEl  = document.getElementById("passcode");
  const btnEl   = document.getElementById("btn");
  const resEl   = document.getElementById("result");

  modeEl.addEventListener("change", () => {
    const m = modeEl.value;
    labelEl.textContent = (m === "phone") ? "æ‰‹æœºå·" : "ç½‘å";
    inputEl.placeholder = (m === "phone") ? "è¯·è¾“å…¥æ‰‹æœºå·" : "è¯·è¾“å…¥ç½‘åï¼ˆä½ ç™»è®°è¿‡çš„é‚£ä¸ªï¼‰";
  });

  function show(html, isErr=false){
    resEl.style.display = "block";
    resEl.innerHTML = isErr ? `<div class="err">${html}</div>` : html;
  }

  btnEl.addEventListener("click", async () => {
    const mode = modeEl.value;
    const key = inputEl.value.trim();
    const passcode = passEl.value.trim();

    if(!key) return show("ä½ è¿˜æ²¡è¾“å…¥å‘¢ï½", true);

    btnEl.disabled = true;
    show("çŒ«çŒ«æ­£åœ¨è¹²å¿«é€’è½¦â€¦", false);

    try{
      const r = await fetch(API_BASE + "/api/query", {
        method:"POST",
        headers:{ "content-type":"application/json" },
        body: JSON.stringify({ mode, key, passcode })
      });

      const data = await r.json();
      if(!r.ok) throw new Error(data?.message || "æŸ¥è¯¢å¤±è´¥");

      const head = `
        <div>
          <span class="pill">çŠ¶æ€ï¼š${data.statusText}</span>
          <span class="pill">è¿å•ï¼š${data.waybillMasked}</span>
        </div>
      `;
      const events = (data.events || []).map(e => `
        <div class="event">
          <div>${e.desc}</div>
          <div class="muted">${e.time}</div>
        </div>
      `).join("");

      show(head + `<div class="timeline">${events || "<div class='muted'>æš‚æ— è½¨è¿¹æ›´æ–°</div>"}</div>`);
    }catch(err){
      show(err.message || "å‡ºé”™äº†", true);
    }finally{
      btnEl.disabled = false;
    }
  });
</script>
</body>
</html>
